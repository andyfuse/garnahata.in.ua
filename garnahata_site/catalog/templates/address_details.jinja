{% extends "base.jinja" %}

{% from "macros/_ownership.jinja" import render_property %}

{% block content %}
        <div class="col">
            <h1>{{ address.title }}</h1>
            {% if address.address %}
            <h2>{{ address.get_city_display() }}, {{ address.address }} {{ address.cadastral_number }}</h2>
            {% endif %}
            {% if address.commercial_name %}
            <h3>{{ address.commercial_name }}</h3>
            {% endif %}
            {{ address.description|safe }}

            {% if address.link %}
                <h5><a href="{{ address.link }}" rel="nofollow" target="_blank">Додаткова інформація</a></h5>
            {% endif %}
        </div>
        
        {% if address.photo or address.coords %}
        <div class="container mt">
                <div class="row">
                    {% if address.photo %}
                    <section class="col-sm-4">
                        <div class="imgResponsiveHeightContainer">
                            <a href="{{ address.photo.url }}" target="_blank">
                            <img class="imgResponsiveHeight" src="{{ address.photo|thumbnail_url("address_thumbnail") }}"/>
                            </a>
                        </div>
                    </section>
                    {% endif %}
                    
                    {% if address.coords %}
                    <section id="bigMap" data-geojson="{{ [address.map_marker()]|jsonify }}" class="geojson-container {% if address.photo %}col-sm-8{% else %}col-sm-12{% endif %}">
                        <h2 class="green text-center">{{ address.title }}</h2>
                        {{ leaflet_map("yourmap") }}
                    </section>
                    {% endif %}
            </div>
       </div>
       {% endif %}
       
        <section id="main" class="col col-sm-12 objectAdress">
            <article>
                <div class="table-responsive">
                    <table class="table objectAdressTable">
                        <thead>
                            <tr>
                                <th>Власник</th>
                                <th>Тип нерухомості, частка</th>
                                <th>Дата реєстрації, підстава власності, форма власності</th>
                                <th><!--Іпотека--></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for group in ownerships|groupby('prop_id') %}
                                {{ render_property(group.list, 
                                                   "active" if loop.index is divisibleby(2) else False,
                                                   tags) }}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </article>
        </section>
{% endblock %}